= 聚集法

设操作当个元素的代价为1

#table(
  columns: (auto, auto),
  inset: 10pt,
  align: horizon,
  [*第i次操作*], [total],
  "1", "0 + 1 + 1 = 2",
  "2", "2 + 1 + 2 = 5",
  "3", "5 + 1 + 0 = 6",
  "4", "10 + 1 + 4 = 15",
  "5", "15 + 1 + 0 = 16",
  "6", "16 + 1 + 0 = 17",
  "7", "17  + 1 + 0 = 18",
  "8", "18  + 1 + 8  = 27",
  "9", "27  + 1 = 28",
  "10", "28  + 1 = 29",
  "...", "...",
  "n", $sum_(i=1)^(floor(log_(2)(n+1)))(2^i) + n$
)


因此, 可以得到$"total" = O(n)$,
即$T(n) = O(n)$, 即总的操作代价为$O(n)$.

那么单次操作$T(1) = T(n) / n = O(1)$

可以得到, 单次操作的平均是$O(1)$

= 会计法

设操作当个元素的代价为1

设摊还代价是 $hat(c_i) = 3 ( 1 + 1 + 1 )$

其中1是当前操作的代价.

第i次操作,
给第 $i$ 个元素存款,
给第 $i - 2^(floor(log_(2)(i)))$ 个元素存款1

当 $i = 2 ^ (k) (k in bold(Z))$,
操作代价是i, 前面的数都已经存过1个代价了,
那么就将前面的存款取出来, 给第i次操作.

经验证, 存款的总和非负, 因此这个分析是正确的

因此, 单次操作的平均代价是$O(1)$


\



= 势能法

设操作当个元素的代价为1

令势能函数$Phi(n) = 2 times n - 2 ^ (floor(log_(2)n) + 1)$, 当n = 0时, $Phi(0)= 0$

令$D_n = n$, $D_0 = 0$, $Phi(n) - Phi(0) = 2(n - 2 ^ (floor(log_(2)n))) >= 0$, 也就是: 总的摊还代价 - 总的真实代价 >= 0

因此, 可以确保这个势能函数是正确的(摊还代价是实际代价的上界)

那么第i次操作的摊还代价是: $hat(c_i) =  Phi(i) - Phi(i-1) = 2 - 2 * (2^(floor(log_(2)i)) - 2^(floor(log_(2)(i-1)))) = O(1)$

因此, 单次操作的平均代价是$O(1)$

